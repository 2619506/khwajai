<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Khwaja AI | Intelligent Analytics</title>

<script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://unpkg.com/three@0.158.0/build/three.min.js"></script>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@500;700;900&family=Outfit:wght@300;400;600&display=swap');

  :root{
    --neon-white: #f8fafc;
    --deep-space: #000000;
  }

  * { box-sizing:border-box; }
  html, body { height:100%; }
  body {
    margin: 0; overflow: hidden; background: #020617; 
    color: var(--neon-white);
    font-family: 'Outfit', sans-serif;
    letter-spacing: 0.5px;
  }

  /* Starfield */
  canvas#stars { position:fixed; inset:0; z-index:-3; }

  /* --- PLANET TEXTURES --- */
  
  /* 1. EARTH (Main) - Adjusted Border for Natural Look */
  .earth-surface {
    border-radius: 50%;
    /* Rich Earth Gradient */
    background: radial-gradient(
      circle at 35% 35%, 
      #4ade80 0%,      /* Highlight */
      #059669 25%,     /* Land */
      #0369a1 50%,     /* Ocean */
      #0f172a 85%,     /* Deep Ocean */
      #020617 100%     /* Shadow */
    );
    /* Softened shadow to remove harsh blue line */
    box-shadow: 
      inset 10px 10px 60px rgba(255,255,255,0.15), 
      inset -20px -20px 80px rgba(0,0,0,0.95),
      0 0 40px rgba(14, 165, 233, 0.15); /* Very subtle outer glow */
    
    /* Removed the explicit border line */
    border: none; 
    position: relative;
  }

  /* 2. MOON (Satellites) - Updated for Natural Grey & Black Text */
  .moon-surface {
    border-radius: 50%;
    /* Natural Moon Grey Gradient */
    background: radial-gradient(
      circle at 30% 30%, 
      #e2e8f0 0%,      /* Bright Grey Highlight */
      #94a3b8 30%,     /* Mid Grey */
      #64748b 60%,     /* Shadow Edge */
      #1e293b 90%,     /* Dark Side */
      #020617 100%
    );
    box-shadow: 
      inset 2px 2px 10px rgba(255,255,255,0.3), 
      0 0 15px rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255,255,255,0.1); /* Very faint rim */
    cursor: pointer;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    
    /* TEXT COLOR CHANGE: Black for visibility */
    color: #0f172a !important; 
    text-shadow: 0 1px 1px rgba(255,255,255,0.5); /* Light shadow for contrast */
  }
  
  .moon-surface:hover {
    transform: scale(1.15);
    box-shadow: 0 0 25px rgba(255, 255, 255, 0.3);
    z-index: 50;
  }

  /* 3. NEON ORANGE (Portfolio) */
  .orange-planet {
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #fff7ed 0%, #fdba74 20%, #f97316 50%, #c2410c 80%, #431407 100%);
    box-shadow: inset 5px 5px 20px rgba(255,255,255,0.5), 0 0 40px rgba(249, 115, 22, 0.6);
    cursor: pointer;
    transition: transform 0.3s;
    animation: floatPortfolio 6s ease-in-out infinite;
    color: #451a03; 
    text-shadow: 0 1px 2px rgba(255,255,255,0.5);
  }
  .orange-planet:hover { transform: scale(1.15); box-shadow: 0 0 60px rgba(249, 115, 22, 0.8); }
  @keyframes floatPortfolio { 0%,100%{transform:translateY(0)} 50%{transform:translateY(10px)} }


  /* --- MAIN LAYOUT --- */
  .wheel {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
    width: min(60vw, 500px); height: min(60vw, 500px);
    z-index: 10;
  }

  /* SATELLITE MOON POSITIONING */
  .satellite {
    position: absolute;
    width: 90px; height: 90px;
    z-index: 20;
    display: flex; justify-content: center; align-items: center; text-align: center;
    font-family: 'Orbitron', sans-serif; font-size: 0.65rem; font-weight: 800; /* Bold font */
    text-transform: uppercase;
  }

  /* 1. Tools: Left */
  .pos-tools { top: 50%; left: -60px; transform: translateY(-50%); }

  /* 2. AI & ML: Right */
  .pos-ai { top: 50%; right: -60px; transform: translateY(-50%); }

  /* 3. Projects: Bottom */
  .pos-projects { bottom: -60px; left: 50%; transform: translateX(-50%); }

  /* PORTFOLIO (Top Right) */
  .portfolio-orbit {
    position: fixed; top: 8%; right: 8%;
    width: 110px; height: 110px;
    z-index: 100;
    display: flex; justify-content: center; align-items: center;
    font-family: 'Orbitron', sans-serif; font-size: 0.75rem; font-weight: 900;
  }

  /* --- CENTER TEXT --- */
  .center-content {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
    width: 80%; height: 80%;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    pointer-events: none; text-align: center; z-index: 30;
  }

  #ccTitle {
    margin: 0 0 15px 0;
    font-family: 'Orbitron', sans-serif;
    font-size: clamp(2.2rem, 5vw, 3.2rem); 
    font-weight: 900; letter-spacing: 2px;
    color: #ffffff;
    text-shadow: 0 4px 15px rgba(0,0,0,0.6);
  }

  #ccText {
    color: #f1f5f9; font-size: clamp(0.85rem, 1.4vh, 1.0rem);
    line-height: 1.6; font-weight: 400;
    text-wrap: balance; width: 100%; max-width: 420px; 
    text-shadow: 0 2px 5px rgba(0,0,0,0.9);
  }
  
  #ccText b {
    color: #86efac; font-weight: 700; display: block; margin-bottom: 8px;
    font-size: 1.1em; letter-spacing: 1px; text-transform: uppercase;
    border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 8px;
    display: inline-block;
  }
  
  #ccText ul { text-align: left; padding-left: 20px; margin-top: 5px; font-size: 0.9em; }
  #ccText li { margin-bottom: 4px; }

  /* --- CHATBOT DOCK --- */
  .assistant-wrap {
    position: fixed; left: 30px; bottom: 30px; width: 60px; height: 60px;
    z-index: 9999; pointer-events: none;
  }
  .assistant-wrap::before {
    content: ""; position: absolute; inset: 0; border-radius: 50%;
    background: radial-gradient(circle at center, rgba(34, 197, 94, 0.8) 0%, rgba(21, 128, 61, 0.4) 40%, transparent 100%);
    box-shadow: 0 0 20px rgba(34, 197, 94, 0.6);
    animation: pulseGlow 4s ease-in-out infinite;
    z-index: -1; pointer-events: none;
  }
  @keyframes pulseGlow { 0%,100%{opacity:0.8; transform:scale(1);} 50%{opacity:1; transform:scale(1.1);} }

  /* OVERLAY STYLES */
  .overlay { position: fixed; inset: 0; display: none; place-items: center; z-index: 500; background: radial-gradient(ellipse at center, rgba(15, 23, 42, 0.95) 0%, rgba(2, 6, 23, 0.98) 80%); animation: fadeIn 300ms ease-out; }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  .panel { width: min(1200px, 92vw); height: min(78vh, 820px); border: 1px solid rgba(255,255,255,0.1); background: linear-gradient(180deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.98)); border-radius: 24px; box-shadow: 0 20px 60px rgba(0,0,0,0.8); backdrop-filter: blur(15px); position: relative; overflow: hidden; }
  .panel-header { display: flex; align-items: center; justify-content: space-between; padding: 14px 18px; border-bottom: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); }
  .close-btn { width: 36px; height: 36px; border-radius: 50%; border: 1px solid #fff; background: transparent; color: #fff; cursor: pointer; display: grid; place-items: center; }
  .panel-body { display: grid; grid-template-columns: 320px 1fr; gap: 16px; height: calc(100% - 62px); padding: 16px; }
  .controls { overflow-y: auto; } .chart-wrap { position: relative; height: 100%; border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 8px; background: rgba(0,0,0,0.3); }
  .card { border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 12px; margin-bottom: 12px; background: rgba(255,255,255,0.03); }
  input, select, button { width: 100%; padding: 10px; margin-top: 5px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.5); color: #fff; }
  .btn { cursor: pointer; font-weight: bold; text-transform: uppercase; } .btn:hover { background: rgba(255,255,255,0.1); }
  #sphereWrap { position: absolute; inset: 8px; border-radius: 12px; overflow: hidden; z-index: 0; pointer-events: none; }
  canvas#sphere { width: 100%; height: 100%; display: block; filter: drop-shadow(0 0 10px var(--neon-white)); opacity: 0.6; }
  .insights { position: absolute; left: 16px; right: 16px; bottom: 16px; z-index: 2; background: rgba(15, 23, 42, 0.9); border: 1px solid rgba(255,255,255,0.2); border-radius: 12px; padding: 10px; color: var(--neon-white); font-size: 0.85rem; }
  
  /* RESPONSIVE */
  @media (max-width: 980px){ 
    .panel-body { grid-template-columns: 1fr; height: auto; } 
    .chart-wrap { height: 50vh; } 
    #sphereWrap { display: none; }
    
    .wheel { width: 75vw; height: 75vw; }
    .satellite { width: 65px; height: 65px; font-size: 0.5rem; }
    
    /* Mobile positions */
    .pos-tools { left: -30px; }
    .pos-ai { right: -30px; }
    .pos-projects { bottom: -30px; }
    
    .portfolio-orbit { top: 20px; right: 20px; width: 80px; height: 80px; font-size: 0.65rem; }
    #ccTitle { font-size: 1.8rem; }
    #ccText { font-size: 0.75rem; line-height: 1.3; }
  }
</style>
</head>
<body>

<canvas id="stars"></canvas>

<div class="wheel earth-surface" id="wheel">
  
  <div class="satellite moon-surface pos-tools" onclick="openOverlay()">
    Tools
  </div>

  <div class="satellite moon-surface pos-ai" onclick="showAIML()">
    AI & ML
  </div>

  <div class="satellite moon-surface pos-projects" onclick="showProjects()">
    Projects
  </div>

  <div class="center-content" id="centerContent">
    <h1 id="ccTitle">KHWAJA AI</h1>
    <p id="ccText">
      <b>AI & Business Analytics Strategist</b>
      Merging an MSc in Business Analytics & Finance with over 5 years of operational expertise. From streamlining diplomatic workflows to driving data-led strategies in retail, I bridge the gap between technical insights and executive decision-making. I specialize in optimizing processes, financial modeling, and delivering actionable intelligence using Python, SQL, and Power BI.
    </p>
  </div>
</div>

<div class="portfolio-orbit orange-planet" onclick="window.open('/portfolio/', '_blank')">
  Portfolio
</div>

<div class="assistant-wrap">
  <div class="assistant-hole"></div>
</div>

<div id="analyzerOverlay" class="overlay" aria-hidden="true">
  <div class="panel" role="dialog">
    <div class="panel-header">
      <div style="display:flex;align-items:center;gap:10px"><span>üõ∏</span><span style="font-weight:bold;letter-spacing:1px">Khwaja AI Analyzer</span></div>
      <button class="close-btn" onclick="closeOverlay()">‚úï</button>
    </div>
    <div class="panel-body">
      <div class="controls">
        <div class="card">
          <h3>1. Data Upload</h3>
          <label>Dataset 1 (CSV/Excel)</label><input id="file1" type="file" accept=".csv,.xlsx,.xls" />
          <label>Dataset 2 (CSV/Excel)</label><input id="file2" type="file" accept=".csv,.xlsx,.xls" />
        </div>
        <div class="card">
          <h3>2. Configuration</h3>
          <label>X-Axis</label> <select id="x1" disabled></select>
          <label>Y-Axis</label> <select id="y1" disabled></select>
          <label>Chart Type</label>
          <select id="chartType" disabled>
            <option value="scatter">Scatter</option><option value="line">Line</option><option value="bar">Bar</option>
            <option value="area">Area</option><option value="pie">Pie</option><option value="heatmap">Heatmap</option>
          </select>
        </div>
        <div class="card">
          <h3>3. Action</h3>
          <button id="vizBtn" class="btn" onclick="plotData()" disabled>Visualize Data</button>
        </div>
        <div class="card">Status: <span id="status">Waiting for files...</span></div>
      </div>
      <div class="chart-wrap">
        <div id="sphereWrap"><canvas id="sphere"></canvas></div>
        <div id="chart"></div>
        <div id="insights" class="insights" style="display:none;"></div>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  if(!window.chatbase || window.chatbase("getState")!=="initialized"){
    window.chatbase=(...arguments)=>{ if(!window.chatbase.q){window.chatbase.q=[]} window.chatbase.q.push(arguments) };
    window.chatbase=new Proxy(window.chatbase,{ get(target,prop){ if(prop==="q"){return target.q} return(...args)=>target(prop,...args) } });
  }
  const onLoad=function(){
    const script=document.createElement("script");
    script.src="https://www.chatbase.co/embed.min.js";
    script.id="85-fKKKuG65obFx8ejTz3";
    script.domain="www.chatbase.co";
    document.body.appendChild(script);
  };
  if(document.readyState==="complete"){onLoad()} else { window.addEventListener("load", onLoad) }
})();
/* Move Chatbase to Dock */
window.addEventListener("load", function(){
  setTimeout(()=>{
    const bubble = document.querySelector("#chatbase-bubble, iframe[src*='chatbase']");
    if(bubble){
      bubble.style.position = "absolute"; bubble.style.bottom = "50%"; bubble.style.left = "50%";
      bubble.style.transform = "translate(-50%, 50%) scale(0.9)"; bubble.style.zIndex = "12";
      document.querySelector(".assistant-wrap").appendChild(bubble);
    }
  }, 2500);
});
</script>

<script>
const canvas = document.getElementById('stars');
const ctx = canvas.getContext('2d');
let stars = [], meteors = [];
function resizeCanvas(){ canvas.width = innerWidth; canvas.height = innerHeight; }
resizeCanvas(); addEventListener('resize', resizeCanvas);
function createStars(count){ stars=[]; for(let i=0;i<count;i++){ stars.push({ x:Math.random()*canvas.width, y:Math.random()*canvas.height, speed:Math.random()*0.2+0.05, size:Math.random()*1.5 }); } }
function createMeteors(count){ meteors=[]; for(let i=0;i<count;i++){ meteors.push({ x:Math.random()*canvas.width, y:Math.random()*canvas.height, speedX:-(Math.random()*4+2), speedY:Math.random()*2+1, length:Math.random()*50+30 }); } }
function drawStars(){ 
  ctx.clearRect(0,0,canvas.width,canvas.height); ctx.fillStyle = '#ffffff'; 
  for(const s of stars){ ctx.beginPath(); ctx.arc(s.x,s.y,s.size,0,Math.PI*2); ctx.fill(); s.y+=s.speed; if(s.y>canvas.height){s.y=0;s.x=Math.random()*canvas.width;} } 
  ctx.strokeStyle = '#ffffff'; ctx.lineWidth=0.8;
  for(const m of meteors){ ctx.beginPath(); ctx.moveTo(m.x,m.y); ctx.lineTo(m.x+m.length*m.speedX/10, m.y+m.length*m.speedY/10); ctx.stroke(); m.x+=m.speedX; m.y+=m.speedY; if(m.x<-100||m.y>canvas.height+100){m.x=canvas.width+Math.random()*200;m.y=Math.random()*canvas.height/2;} } 
}
createStars(300); createMeteors(3);
(function animate(){ drawStars(); requestAnimationFrame(animate); })();

/* Wheel Rotation */
const wheel = document.getElementById('wheel');
document.addEventListener('mousemove', e=>{ 
  const centerX = innerWidth/2; const offsetX = e.clientX - centerX; 
  const rotation = offsetX/40; 
  wheel.style.transform = `translate(-50%, -50%) rotate(${rotation}deg)`; 
});

/* Home & UI Logic */
function showProjects(){
  const cc = document.getElementById('centerContent');
  cc.innerHTML = `
    <h1 id="ccTitle" style="font-size:2.5rem">KEY PROJECTS</h1>
    <div id="ccText" style="text-align:left; font-size:0.9rem;">
      <ul style="list-style-type:none; padding:0;">
        <li style="margin-bottom:10px;"><b>üõçÔ∏è iOutlet Revenue Analysis</b> Analyzed 32,000+ sales transactions (¬£8.9M) to identify seasonal trends and built Python dashboards for reporting.</li>
        <li style="margin-bottom:10px;"><b>üçÑ Sustainable Production (AREA)</b> Managed an ¬£80k donor-funded project, coordinating field teams and streamlining reporting workflows by 50%.</li>
        <li><b>üìà Financial Forecasting (Uni. Dundee)</b> Developed equity price forecasting models using MATLAB & R, improving predictive accuracy through back-testing.</li>
      </ul>
      <div style="text-align:center; margin-top:10px; font-size:0.8rem; color:#94a3b8;">(Click 'Portfolio' for full details)</div>
    </div>
  `;
}

function showAIML(){
  const cc = document.getElementById('centerContent');
  cc.innerHTML = `
    <h1 id="ccTitle" style="font-size:2.5rem">AI & MACHINE LEARNING</h1>
    <div id="ccText">
      <b>Technical Arsenal</b>
      <p>Proficient in deploying <b>Python</b> (Pandas, Scikit-Learn) and <b>R</b> for predictive modeling.</p>
      <br>
      <b>Core Competencies</b>
      <ul style="display:inline-block; text-align:left;">
        <li>‚Ä¢ Financial Forecasting (ARIMA/Time-Series)</li>
        <li>‚Ä¢ Purchasing Behavior Modeling</li>
        <li>‚Ä¢ Regression Analysis & KPI Design</li>
        <li>‚Ä¢ Automated Streamlit Dashboards</li>
      </ul>
    </div>
  `;
}

function showHome(){
  const cc = document.getElementById('centerContent');
  cc.innerHTML = `<h1 id="ccTitle">KHWAJA AI</h1><p id="ccText"><b>AI & Business Analytics Strategist</b>Merging an MSc in Business Analytics & Finance with over 5 years of operational expertise. From streamlining diplomatic workflows to driving data-led strategies in retail, I bridge the gap between technical insights and executive decision-making. I specialize in optimizing processes, financial modeling, and delivering actionable intelligence using Python, SQL, and Power BI.</p>`;
}

function openOverlay(){ document.getElementById('analyzerOverlay').style.display = 'grid'; startSphere(); onResizeSphere(); }
function closeOverlay(){ document.getElementById('analyzerOverlay').style.display = 'none'; stopSphere(); }

/* Chart/File Logic */
let dataset1 = [], dataset2 = [];
const el = id => document.getElementById(id);
const setStatus = msg => el('status').textContent = msg;
function setControlsEnabled(enabled){ ['x1','y1','chartType','vizBtn'].forEach(id=>{ if(el(id)) el(id).disabled=!enabled; }); }
el('file1').addEventListener('change', e=> loadFile(e.target.files[0], 1));
el('file2').addEventListener('change', e=> loadFile(e.target.files[0], 2));
function loadFile(file, idx){ 
  if(!file) return; 
  setStatus(`Loading ${file.name}...`);
  if(file.name.endsWith('.csv')){ Papa.parse(file, {header:true, dynamicTyping:true, complete: res => assignData(res.data, idx)}); }
  else { setStatus("Excel parsing requires server or fuller library setup."); } 
}
function assignData(data, idx){ 
  const clean = data.filter(r => Object.values(r).some(v=>v!==null));
  if(idx===1) dataset1=clean; else dataset2=clean;
  setStatus(`Loaded dataset ${idx} (${clean.length} rows)`);
  if(dataset1.length || dataset2.length) { populateDropdowns(); setControlsEnabled(true); }
}
function populateDropdowns(){
  const keys = Object.keys(dataset1[0] || dataset2[0] || {});
  ['x1','y1'].forEach(id => { el(id).innerHTML = keys.map(k=>`<option>${k}</option>`).join(''); });
}
function plotData(){
  const xKey = el('x1').value, yKey = el('y1').value, type = el('chartType').value;
  const trace1 = { x: dataset1.map(r=>r[xKey]), y: dataset1.map(r=>r[yKey]), type: type==='scatter'?'scatter':type, mode:'markers' };
  Plotly.newPlot('chart', [trace1], { paper_bgcolor:'rgba(0,0,0,0)', plot_bgcolor:'rgba(0,0,0,0)', font:{color:'#fff'} });
}

/* 3D Sphere Logic */
let sphereScene, sphereCamera, sphereRenderer, sphereMesh, sphereReq;
function startSphere(){
  const wrap = document.getElementById('sphereWrap');
  const canvas = document.getElementById('sphere');
  sphereScene = new THREE.Scene();
  const w = wrap.clientWidth, h = wrap.clientHeight;
  sphereCamera = new THREE.PerspectiveCamera(35, w/h, 0.1, 1000); sphereCamera.position.z = 6;
  sphereRenderer = new THREE.WebGLRenderer({canvas, antialias:true, alpha:true});
  sphereRenderer.setSize(w,h,false);
  const geo = new THREE.SphereGeometry(2.2, 48, 48);
  const mat = new THREE.MeshPhongMaterial({ color: 0x94a3b8, emissive: 0x0f172a, shininess: 30, transparent:true, opacity:0.6, wireframe:true });
  sphereMesh = new THREE.Mesh(geo, mat); sphereScene.add(sphereMesh);
  const glow = new THREE.PointLight(0xffffff, 1, 50); glow.position.set(4,4,6); sphereScene.add(glow);
  const animate = ()=>{ sphereMesh.rotation.y += 0.0025; sphereRenderer.render(sphereScene, sphereCamera); sphereReq = requestAnimationFrame(animate); };
  animate();
}
function stopSphere(){ if(sphereReq) cancelAnimationFrame(sphereReq); }
function onResizeSphere(){ if(sphereRenderer) { const w = el('sphereWrap').clientWidth, h = el('sphereWrap').clientHeight; sphereRenderer.setSize(w,h,false); sphereCamera.aspect=w/h; sphereCamera.updateProjectionMatrix(); } }
addEventListener('resize', onResizeSphere);
</script>

</body>
</html>
