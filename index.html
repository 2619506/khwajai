<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Khwaja AI Analyzer v2075</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

:root {
  --alien-green: #00ffc6;
}

body {
  margin: 0;
  font-family: 'Share Tech Mono', monospace;
  background: radial-gradient(circle at center, #000 0%, #020d0a 100%);
  color: var(--alien-green);
  overflow-x: hidden;
}

h1 {
  text-align: center;
  text-shadow: 0 0 10px var(--alien-green), 0 0 40px var(--alien-green);
  margin-top: 20px;
}

.analyzer-container {
  max-width: 900px;
  margin: auto;
  background: rgba(0, 0, 0, 0.8);
  padding: 20px;
  border-radius: 20px;
  box-shadow: 0 0 40px var(--alien-green), inset 0 0 30px rgba(0, 255, 198, 0.4);
  border: 1px solid var(--alien-green);
}

label {
  display: block;
  margin-top: 15px;
  font-size: 0.9em;
  letter-spacing: 1px;
}

input[type="file"] {
  margin-top: 5px;
}

canvas {
  margin-top: 20px;
}

button {
  background: transparent;
  border: 2px solid var(--alien-green);
  color: var(--alien-green);
  padding: 8px 16px;
  margin-top: 15px;
  cursor: pointer;
  border-radius: 10px;
  transition: all 0.3s ease;
  text-shadow: 0 0 8px var(--alien-green);
}

button:hover {
  background: var(--alien-green);
  color: black;
  box-shadow: 0 0 20px var(--alien-green);
}

#insights {
  margin-top: 20px;
  padding: 15px;
  background: rgba(0,0,0,0.6);
  border-radius: 10px;
  font-size: 0.85em;
  line-height: 1.4em;
  box-shadow: inset 0 0 10px var(--alien-green);
}
</style>
</head>
<body>

<h1>Khwaja AI Analyzer v2075</h1>
<div class="analyzer-container">
  <label>Upload Dataset 1 (X-axis values)</label>
  <input type="file" id="fileX" accept=".xlsx,.xls,.csv" />

  <label>Upload Dataset 2 (Y-axis values)</label>
  <input type="file" id="fileY" accept=".xlsx,.xls,.csv" />

  <label>Select Chart Type</label>
  <select id="chartType">
    <option value="line">Line</option>
    <option value="bar">Bar</option>
    <option value="scatter">Scatter</option>
    <option value="radar">Radar</option>
    <option value="polarArea">Polar Area</option>
    <option value="doughnut">Doughnut</option>
  </select>

  <button onclick="generateChart()">Generate Chart</button>
  <button onclick="downloadChart()">Download Chart</button>

  <canvas id="myChart"></canvas>

  <div id="insights"></div>
</div>

<script>
let xData = [];
let yData = [];

function parseFile(file, callback) {
  const reader = new FileReader();
  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, { type: 'array' });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
    const flatData = json.flat().filter(v => v !== null && v !== '');
    callback(flatData.slice(1)); // skip header if present
  };
  reader.readAsArrayBuffer(file);
}

document.getElementById('fileX').addEventListener('change', function(e) {
  parseFile(e.target.files[0], data => xData = data);
});
document.getElementById('fileY').addEventListener('change', function(e) {
  parseFile(e.target.files[0], data => yData = data);
});

function generateChart() {
  if (!xData.length || !yData.length) {
    alert("Please upload both datasets.");
    return;
  }

  const ctx = document.getElementById('myChart').getContext('2d');
  if (window.myChart) window.myChart.destroy();

  // Simulated AI prediction
  const predictedY = yData.map(v => v * (1 + (Math.random() - 0.5) / 5));

  window.myChart = new Chart(ctx, {
    type: document.getElementById('chartType').value,
    data: {
      labels: xData,
      datasets: [
        {
          label: 'Actual Data',
          data: yData,
          borderColor: '#00ffc6',
          backgroundColor: 'rgba(0,255,198,0.3)',
          borderWidth: 2
        },
        {
          label: 'AI Prediction',
          data: predictedY,
          borderColor: '#ff00ff',
          backgroundColor: 'rgba(255,0,255,0.3)',
          borderDash: [5,5],
          borderWidth: 2
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          labels: { color: '#00ffc6' }
        }
      },
      scales: {
        x: { ticks: { color: '#00ffc6' } },
        y: { ticks: { color: '#00ffc6' } }
      }
    }
  });

  generateInsights(yData, predictedY);
}

function generateInsights(actual, predicted) {
  let avgActual = (actual.reduce((a,b) => a+b, 0) / actual.length).toFixed(2);
  let avgPred = (predicted.reduce((a,b) => a+b, 0) / predicted.length).toFixed(2);
  let diff = ((avgPred - avgActual) / avgActual * 100).toFixed(2);

  document.getElementById('insights').innerHTML = `
    <strong>Alien Command Report:</strong><br>
    Average Actual Value: ${avgActual}<br>
    Average Predicted Value: ${avgPred}<br>
    Predicted Change: ${diff}%<br>
    Observation: ${diff > 0 ? "Expected Increase" : "Possible Decrease"} in future values.
  `;
}

function downloadChart() {
  const link = document.createElement('a');
  link.href = document.getElementById('myChart').toDataURL('image/png');
  link.download = 'khwaja_ai_chart.png';
  link.click();
}
</script>

</body>
</html>
